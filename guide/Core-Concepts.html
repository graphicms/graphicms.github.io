<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Core concepts | GraphiCMS</title>
    <meta name="description" content="The missing bridge between PHP and GraphQL/MongoDB developers">
    
    
    <link rel="preload" href="/assets/css/0.styles.e4508724.css" as="style"><link rel="preload" href="/assets/js/app.0ca97ba7.js" as="script"><link rel="preload" href="/assets/js/4.d43f6e08.js" as="script"><link rel="prefetch" href="/assets/js/10.a52576ae.js"><link rel="prefetch" href="/assets/js/2.e7664fad.js"><link rel="prefetch" href="/assets/js/3.bbdda4ea.js"><link rel="prefetch" href="/assets/js/5.d7cc4f9c.js"><link rel="prefetch" href="/assets/js/6.3de46129.js"><link rel="prefetch" href="/assets/js/7.dae406bd.js"><link rel="prefetch" href="/assets/js/8.9a07d9bb.js"><link rel="prefetch" href="/assets/js/9.a01515bc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4508724.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">GraphiCMS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>Documentation</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/guide/" class="sidebar-link">Introduction</a></li><li><a href="/guide/Core-Concepts.html" class="active sidebar-link">Core concepts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#graphql-package" class="sidebar-link">GraphQL Package</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#schemas" class="sidebar-link">Schemas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#what-if-i-do-not-want-to-use-service-providers-for-registering-code" class="sidebar-link">What if I do not want to use Service Providers for registering code?</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#types" class="sidebar-link">Types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#registering-a-new-type" class="sidebar-link">Registering a new type</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#enum-type" class="sidebar-link">Enum Type</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#union-type" class="sidebar-link">Union Type</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#type-modifiers" class="sidebar-link">Type modifiers</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#input-types" class="sidebar-link">Input types</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#queries" class="sidebar-link">Queries</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#mutations" class="sidebar-link">Mutations</a></li><li class="sidebar-sub-header"><a href="/guide/Core-Concepts.html#full-example-with-core-concepts" class="sidebar-link">Full example with Core Concepts</a></li></ul></li><li><a href="/guide/Generated-schema-info.html" class="sidebar-link">Generated schema info</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Examples</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="core-concepts"><a href="#core-concepts" aria-hidden="true" class="header-anchor">#</a> Core concepts</h1> <h2 id="graphql-package"><a href="#graphql-package" aria-hidden="true" class="header-anchor">#</a> GraphQL Package</h2> <p>Because most of the GraphQL schema is dynamically generated, we had to modify some small features from <a href="https://github.com/rebing/graphql-laravel" target="_blank" rel="noopener noreferrer">rebing/graphql-laravel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and that's how <a href="https://github.com/graphicms/graphql" target="_blank" rel="noopener noreferrer">graphicms/graphql<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> package was born. Most of the behaviour is the same, but we had to make uses of closures in parts of the schema definition to lazily evaluate the types. We also pre-configured the package to meet our package's requirements. You do not have to install it separately or configure it.</p> <p>The package is auto-discovered by the Laravel <code>php artisan package:discover</code> command.</p> <p>It automatically registers the service provider <code>Graphicms\GraphQL\GraphQLServiceProvider</code>  and an alias called <code>CmsQL</code> that points to the <code>Graphicms\GraphQL\GraphQLFacade</code> facade.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Most of the operations you will learn about below are done automatically by the system when you define a new collection in the control panel. In a simple scenario, you don't have to register schemas, types, queries or mutations by code only if you want to re-use them or make an extension for GraphiCMS. Still, it's good to learn about the foundation building blocks because that's what GraphiCMS is using behind the scenes.</p></div> <h2 id="schemas"><a href="#schemas" aria-hidden="true" class="header-anchor">#</a> Schemas</h2> <p>You can have multiple GraphQL endpoints by defining schemas. By default there are two endpoints configured by the system: <code>default</code> and <code>backend</code>. You can register additional schemas using the <code>CmsQl</code> class. For example, this is how the package registers the backend scheme that is used by the control panel:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addNewScheme</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'backend'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'middleware'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'web'</span><span class="token punctuation">,</span> Authenticate<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> OnlyFromBackend<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>You can add any middleware for the schema. For example, you can have one public schema that is read only, but add a new one that requires authentication to read and update it.</p> <p>You can also provide the queries and mutations at registration type by passing two additional keys: <code>query</code> and <code>mutation</code>. This behaviour is inherited from the <code>rebing/laravel-graphql</code> package. Example:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addNewScheme</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'blog'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'query'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'example_query'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> ExampleQuery<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'mutation'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'example_mutation'</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> ExampleMutation<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Using this way to define the GraphQL Schema is fine, but GrahiCMS provides an easier way to register schemas, types and mutations and you'll learn about the &quot;Graphi way&quot; soon.</p> <p>Schemas are by default accessible using the following route: <code>/graphi/api/{scheme?}</code>. If a scheme is not defined, the <code>default</code> one will be used. If, for example, you want to query or mutate the <code>backend</code> scheme, you access it under <code>/graphi/api/backend</code> using POST or GET.</p> <p>In a nutshell, schemas are a collection of types, mutations and queries. Everything but types are scoped to a schema. Types are defined once and can be used in any schema.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <h3 id="what-if-i-do-not-want-to-use-service-providers-for-registering-code"><a href="#what-if-i-do-not-want-to-use-service-providers-for-registering-code" aria-hidden="true" class="header-anchor">#</a> What if I do not want to use Service Providers for registering code?</h3> <p><a name="graphi-loaders"></a>
GraphiCMS is configured to look into your app folder if there are files named *<em>Graphi/<em>Loader.php</em></em>. If there is one, it will autoload it using the DI Container (which means you can typehint any dependencies that you need and Laravel will inject those.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">// app/Graphi/MyLoader.php</span>
<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Graphi<span class="token punctuation">\</span>MyLoader</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Application</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Graphicms<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>Events<span class="token punctuation">\</span>ServingGraphQL</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyLoader</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>Application <span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'events'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">listen</span><span class="token punctuation">(</span>ServingGraphQL<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// here you would register your custom things.</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>You can have as many Loaders as you want, GraphiCMS will load all of them.</p></div> <h2 id="types"><a href="#types" aria-hidden="true" class="header-anchor">#</a> Types</h2> <p>As you might already know, GraphQL is strongly-typed. This means that every field must have a type. This way, you know  that the response from the GraphQL endpoint will have a certain structure.</p> <p>GraphiCMS defines most of the types for you, based on the collections you define in the control panel. There are cases when you want to define a type in code, for example when building an extension for GraphiCMS and want the schema to be encapsulated in the extension.</p> <h3 id="registering-a-new-type"><a href="#registering-a-new-type" aria-hidden="true" class="header-anchor">#</a> Registering a new type</h3> <p>Registering a new type in GraphiCMS' api is pretty simple using the <code>CmsQL::addType()</code> function. There are two main approaches for registering your own types, and we will learn both of them now.</p> <h4 id="_1-creating-a-new-class-and-registering-more-complicated"><a href="#_1-creating-a-new-class-and-registering-more-complicated" aria-hidden="true" class="header-anchor">#</a> 1. Creating a new class and registering [More complicated]</h4> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>Type</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserType</span> <span class="token keyword">extends</span> <span class="token class-name">GraphQLType</span>
<span class="token punctuation">{</span>    
    <span class="token keyword">protected</span> <span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'name'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'description'</span>   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'A user'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'model'</span>         <span class="token operator">=</span><span class="token operator">&gt;</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'id'</span>                <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'name'</span>              <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email'</span>             <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email_verified_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'password'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'remember_token'</span>    <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'created_at'</span>        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'updated_at'</span>        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If you want to resolve the field yourself, you can declare a method</span>
    <span class="token comment">// with the following format resolve[FIELD_NAME]Field()</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">resolveEmailField</span><span class="token punctuation">(</span><span class="token variable">$root</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$root</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">email</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>After having the class defined, you need to register it in the system like so:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addType</span><span class="token punctuation">(</span>App\<span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>UserType</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-creating-a-dynamictype-in-a-service-provider-graphicms-preferred-way"><a href="#_2-creating-a-dynamictype-in-a-service-provider-graphicms-preferred-way" aria-hidden="true" class="header-anchor">#</a> 2. Creating a &quot;DynamicType&quot; in a Service Provider [GraphiCMS preferred way]</h4> <p>This is how core types are registered internally by the package. By making use of this approach, you do not have to create a new class for every type you need, you just make use of the class we provide in the package <code>\Graphicms\Cms\GraphQL\DynamicType</code>. You can use the static <code>make</code> function to define a new type. The <code>DynamicType::make</code> signature is as it follows:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>DynamicType<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span>
    <span class="token keyword">array</span> <span class="token variable">$attributes</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span> <span class="token variable">$fields</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span> <span class="token variable">$resolvers</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">array</span> <span class="token variable">$interfaces</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>As you can see, only <code>$attributes</code> and <code>$fields</code> are needed to define a new Type.</p> <p><code>$attributes</code> can be one of the following:</p> <table><thead><tr><th>key</th> <th>description</th> <th>required</th></tr></thead> <tbody><tr><td>name</td> <td>The name of the new type.</td> <td>yes</td></tr></tbody></table> <p><code>$fields</code> is the array containing the fields for the new type.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> \<span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> \<span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'created_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> \<span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>$resolvers</code> is an array with additional resolvers for your fields. You can use resolvers for columns that are not returned in your main array of data or for modifying columns. Resolvers use the convention of naming <code>resolve{FieldName}Field</code> where FieldName is your field name in StudlyCase. For example, to modify the format of your created_at field, pass an resolver:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'resolveCreatedAtField'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$root</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$root</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">created_at</span> <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token punctuation">\</span>Carbon<span class="token punctuation">\</span>Carbon</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$root</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">created_at</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Resolvers can also be passed in the field definition, where you define <code>type</code> too and never use the resolvers variable:</p> <div class="language-php line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token single-quoted-string string">'created_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> \<span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'resolver'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$root</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$root</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">created_at</span> <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token punctuation">\</span>Carbon<span class="token punctuation">\</span>Carbon</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token variable">$root</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">created_at</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'U'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>$interfaces</code> allow some fields to be re-used amongst other types. Read about GraphQL interfaces <a href="https://graphql.org/learn/schema/#interfaces" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Interfaces are useful if you re-use the same fields for many types. We provide two core interfaces: <code>IsSoftDeleting</code> and <code>HasDates</code>. You will need to add those interfaces if you have the dates attributes <code>created_at</code> and <code>updated_at</code> or your type is being soft deleted and has <code>deleted_at</code> column.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token punctuation">[</span>
    \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HasDates'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'IsSoftDeleting'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><a name="registerTypesEarly"></a></p> <p>Adding those interfaces in the $interfaces parameter will automatically add <code>created_at, updated_at</code> and <code>deleted_at</code> fields and would automatically resolve those fields.</p> <p>It is better to register types earliest in the app lifecycle for example in the <code>register</code> method of a Service Provider.</p> <p>Full example of registering a new GraphQL type in a Service Provider:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package">Graphicms<span class="token punctuation">\</span>Cms<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>DynamicType</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>ServiceProvider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addType</span><span class="token punctuation">(</span>DynamicType<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HasDates'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'IsSoftDeleting'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>Having the code above, you can now reference to the type using the <code>\CmsQL::type($name)</code> function.</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p><strong>Beware of not-defined errors with closures</strong></p> <p>As a general rule of thumb, if you reference non-standard types (a user defined type not Int, String or Boolean or any other field from GraphQL standard), it is better to wrap the <code>type</code> value in a closure to avoid concurrency issues. Without a closure, you might reference a type that is not yet defined and receive an exception that 'requested type is not registered`.</p></div> <p>Example of avoiding concurrency issues:</p> <div class="language-php line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addType</span><span class="token punctuation">(</span>DynamicType<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'brothers'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">return</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">listOf</span><span class="token punctuation">(</span>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>If you do not provide a closure for the <code>brothers</code> field, you would receive an exception because the type <code>User</code> is not yet defined.</p> <blockquote><p>Exception
Type User not found.</p></blockquote> <p>A closure helps the system to lazily evaluate the type of the field only when needed, not when main type is defined.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>GraphQL comes with a set of default scalar types out of the box that you will use most of the time to compose your own types:</p> <ul><li><code>Int</code> A signed 32‐bit integer.</li> <li><code>Float</code> A signed double-precision floating-point value.</li> <li><code>String</code> A UTF‐8 character sequence.</li> <li><code>Boolean</code> A <code>true</code> or <code>false</code> value</li> <li><code>Id</code> The ID scalar type represents a unique identifier, often used to refetch an object or as the key for a cache. The ID type is serialized in the same way as a String; however, defining it as an ID signifies that it is not intended to be human‐readable.</li></ul></div> <h3 id="enum-type"><a href="#enum-type" aria-hidden="true" class="header-anchor">#</a> Enum Type</h3> <p>There's also a special type called Enum that takes a list of allowed values and the client can now in advance what values might come from the api.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>EnumType</span><span class="token punctuation">;</span>

<span class="token variable">$sizeEnum</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EnumType</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Shoe Size'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Only those are allowed for user\'s shoe size.'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'values'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'SMALL'</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'value'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'SMALL'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token single-quoted-string string">'MEDIUM'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'value'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'MEDIUM'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
        <span class="token single-quoted-string string">'BIG'</span>    <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'value'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'BIG'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addType</span><span class="token punctuation">(</span>DynamicType<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'shoe_size'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$sizeEnum</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HasDates'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            \<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'IsSoftDeleting'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="union-type"><a href="#union-type" aria-hidden="true" class="header-anchor">#</a> Union Type</h3> <p>A union is just a simple collection of types. Imagine you have a query that might search amongst many collections of data. You could search for Users but also Articles. The query responsible for searching could return an SearchResultUnion type with those two possible return types. Then the client that makes the request is responsible to decide what fields they want returned and on what types. Read more about union types <a href="https://graphql.org/learn/schema/#union-types" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>GraphiCMS uses union types for auto generated read queries. When you request a specific <code>id</code> for a collection object, a simple type representing that object (say <code>UserType</code>) is returned. But if you request all the users in the system, a <code>UserCollection</code> type is returned. This includes pagination data(page, per_page, total items and so on) but also includes <code>data</code> that is an array of requested type.</p> <h3 id="type-modifiers"><a href="#type-modifiers" aria-hidden="true" class="header-anchor">#</a> Type modifiers</h3> <p>Object types, scalars, and enums are the only kinds of types you can define in GraphQL. But when you use the types in other parts of the schema, or in your query variable declarations, you can apply additional type modifiers that affect validation of those values.</p> <ul><li><strong>Non-Null</strong>. Wrap a type in <code>\GraphQL\Type\Definition\Type::nonNull($actualType)</code> to mark it as not nullable. This way, when the client is not sending that argument, the query will fail. Also, when you specify a return type as nonNull, you have to always return a value or the query will also fail.</li> <li><strong>Lists/Collections</strong>. When you want to return an array of a certain type, you use <code>\GraphQL\Type\Definition\Type::listOf($actualType)</code>. For example a query that returns a list of users you use <code>\GraphQL\Type\Definition\Type::nonNull(\CmsQL::type('User'))</code></li></ul> <h3 id="input-types"><a href="#input-types" aria-hidden="true" class="header-anchor">#</a> Input types</h3> <p>By default all types that you define are <em>write-only</em>. This means that the API can return them but the client cannot send a parameter of those types. When you register a DynamicType and you want that to be input-enabled too, pass the <code>'input' =&gt; true</code> argument as part of the definition. For example, this is one type registered by GraphiCMS internally:</p> <div class="language-php line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addType</span><span class="token punctuation">(</span>DynamicType<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Pagination'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'input'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'current_page'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'per_page'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>No you can write queries or mutations that accept an argument of type <code>Pagination</code> (if you specify it in the arguments list).</p> <h2 id="queries"><a href="#queries" aria-hidden="true" class="header-anchor">#</a> Queries</h2> <p>Queries are the way you request data from your GraphQL endpoint. Read <a href="https://graphql.org/learn/schema/#the-query-and-mutation-types" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> about the basics of queries. One first notable difference from Types is that <strong>a query belongs to a schema</strong>, whereas types are re-used amongst all schemas. It's also important to note that queries are read-only, they are the equivalent of GET requests in REST.</p> <p>There are two mandatory parts for a query: returning type and resolver.</p> <p id="requiredQueriesParts">A query needs to have **returning type** from the basic ones described above or one that you defined. Returning types can also be wrapped in a [modifier](#type-modifiers), so you can return a list of things or specify that the response is never null.</p> <p>The other thing that is mandatory in a query is the <strong>query resolver</strong>. The resolver is where the data is manipulated and returned as the <em>query response</em>.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>A resolver is for a query what a controller method is for a response in Laravel - a thing that returns data to the one who requested it.</p></div> <p>A query can also have <strong>attributes</strong>. Those attributes allow you to manipulate data in resolvers in certain ways. Attributes have a name, a type (original GraphQL scalar types like string or boolean, or user defined types that are marked as <code>inputType =&gt; true</code>.</p> <p>GraphiCMS allows you to register a query in an easy way by using the <code>DynamicQuery</code> class.</p> <p>The following is an example that registers a query named <code>greetMe</code> that takes an argument too and returns a string:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package">Graphicms<span class="token punctuation">\</span>Cms<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>DynamicQuery</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">;</span>

\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addDynamicQuery</span><span class="token punctuation">(</span>DynamicQuery<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'name'</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'greetMe'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'type'</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'resolver'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$context</span><span class="token punctuation">,</span> <span class="token variable">$arguments</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token double-quoted-string string">&quot;Hello, <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$arguments</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>!&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'args'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">nonNull</span><span class="token punctuation">(</span>Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>The beauty of using nonNull modifiers is that in a resolver you know that you will always have the required data, so in the example above, you don't have to check if <code>$arguments</code> contain a key named <code>name</code> or that it's value is not null. When data hits the resolver, it is already validated.</p> <p>The signature of the addDynamicQuery is:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addDynamicQuery</span><span class="token punctuation">(</span><span class="token variable">$instanceOfDynamicQuery</span><span class="token punctuation">,</span> <span class="token variable">$schema</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If you want to add the query to a specific schema, specify the second parameter. If you want the query to be added on the default schema, leave it as unspecified.</p> <h2 id="mutations"><a href="#mutations" aria-hidden="true" class="header-anchor">#</a> Mutations</h2> <p>Mutations in GraphQL are the equivalent of POST/PUT requests in REST. A mutation is almost identical to a query, except it is meant to produce side-effects (create something, delete, modify). Although you could (at least) theoretically do this in a query, it's against the spec of GraphQL.</p> <p>Mutations, like queries, need at least two things:</p> <ol><li>A returning type</li> <li>A resolver</li></ol> <p>You can look in the <a href="#requiredQueriesParts">query section</a> to see what is the resolver and why a returning type is required, with the notable exception that in a mutation's resolver you can write data to the db/storage too.</p> <p>A mutation can have <strong>validation rules</strong> too. You can use   all the rules from Laravel validation and before hitting the resolver, the system will validate the arguments. If invalid, the errors will be returned to the user/requester and the resolver will never be called.</p> <p>A mutation can be registered in a similar fashion like a query, by using <code>\CmsQL::addDynamicMutation($mutation, $schema = 'default')</code>. You can use the class provided in the package called <code>\Graphicms\Cms\GraphQL\DynamicMutation</code> to register a new mutation. The only different thing is that you can specify a set of <strong>validation rules</strong> for a DynamicMutation.</p> <p>Imagine a mutation that allows a user to change its email address. You can register it like this:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package"><span class="token punctuation">\</span>Graphicms<span class="token punctuation">\</span>Cms<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>DynamicMutation</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package"><span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>Type</span><span class="token punctuation">;</span>

\<span class="token package">CmsQL</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">addDynamicMutation</span><span class="token punctuation">(</span>DynamicMutation<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'changeEmail'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'type'</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'resolver'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$scope</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">email</span> <span class="token operator">=</span> <span class="token variable">$args</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'args'</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">[</span>
                    <span class="token single-quoted-string string">'newEmail'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                        <span class="token single-quoted-string string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">nonNull</span><span class="token punctuation">(</span>Type<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'rules'</span>    <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">[</span>
                    <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'required'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'email'</span><span class="token punctuation">,</span> Rule<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>By defining rules for the above mutation you can rest assured that the input data is validated before hitting the resolver and you can use standard validation rules too.</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <h4 id="when-to-define-types-queries-or-mutations"><a href="#when-to-define-types-queries-or-mutations" aria-hidden="true" class="header-anchor">#</a> When to define Types, Queries or Mutations</h4> <p>When defining Types, it is recommended (as specified <a href="#registerTypesEarly">above</a> too) to register them early in the app lifecycle.</p> <p>However, queries and mutations should be defined only when the api is accessed. This way we gain performance, because the queries are not generated for every request, but also we can be sure that all types we need for queries are generated. To make this process easy, GraphiCMS dispatches an event <code>\Graphicms\GraphQL\Events\ServingGraphQL</code> every time a request is made to a GraphQL schema. Basic example:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">app</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'events'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">listen</span><span class="token punctuation">(</span>ServingGraphQL<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">registerQueries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// all your queries defined here</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">registerMutations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// all your mutations defined here</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>You can use the same event to register types only when those are needed, but listen for the event early in the app lifecycle (like in the register method of a Service Provider)</p></div> <h2 id="full-example-with-core-concepts"><a href="#full-example-with-core-concepts" aria-hidden="true" class="header-anchor">#</a> Full example with Core Concepts</h2> <p>If you want to see a full working example using all the concepts learned in this section, you can see the <a href="/guide/examples/Basic-GraphQL-Crud.html">Basic GraphQL CRUD</a> example.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/" class="prev router-link-active">
          Introduction
        </a></span> <span class="next"><a href="/guide/Generated-schema-info.html">
          Generated schema info
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.0ca97ba7.js" defer></script><script src="/assets/js/4.d43f6e08.js" defer></script>
  </body>
</html>
